!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((t="undefined"!=typeof globalThis?globalThis:t||self).t={})}(this,(function(t){"use strict";class s{constructor(t,s,i,e=t<<16|s<<8|i){this.i=1,this.h=-1,this.o=-1,this.u=-1,this.l=-1,this.g=t,this.M=s,this.p=i,this.m=e}static distance(t,s){return(Math.abs(s.g-t.g)+Math.abs(s.M-t.M)+Math.abs(s.p-t.p))/765}v(){const t=this.g/255,s=this.M/255,i=this.p/255,e=Math.max(t,s,i),n=Math.min(t,s,i);if(this.u=(e+n)/2,e===n)this.o=0,this.h=0,this.l=0;else{const r=e-n;switch(this.h=this.u>.5?r/(2-e-n):r/(e+n),this.l=this.h*(2*(.5-Math.abs(.5-this.u))),e){case t:this.o=((s-i)/r+(s<i?6:0))/6;break;case s:this.o=((i-t)/r+2)/6;break;case i:this.o=((t-s)/r+4)/6}}}get C(){return-1===this.o&&this.v(),this.o}get $(){return-1===this.h&&this.v(),this.h}get _(){return-1===this.u&&this.v(),this.u}get j(){return-1===this.l&&this.v(),this.l}}const i=(t,s)=>Math.abs(t-s);class e{constructor(){this.D=[],this.N=null}O(t){this.D.push(t),this.N=null}P(t,s,e,n){for(let o=0;o<this.D.length;o++){const a=this.D[o];if(!(r=a.C,h=t.C,Math.min(i(r,h),i((r+.5)%1,(h+.5)%1))<s&&i(a.$,t.$)<e&&i(a._,t._)<n))return!1}var r,h;return!0}get W(){if(!this.N){const{r:t,G:i,b:e}=this.D.reduce(((t,s)=>(t.r+=s.g,t.G+=s.M,t.b+=s.p,t)),{r:0,G:0,b:0}),n=this.D.reduce(((t,s)=>t+s.i),0);this.N=new s(Math.round(t/this.D.length),Math.round(i/this.D.length),Math.round(e/this.D.length)),this.N.i=n}return this.N}}class n{constructor(t,s,i){this.I=[],this.C=t,this.$=s,this._=i}O(t){const s=this.I.find((s=>s.P(t,this.C,this.$,this._)));if(s)s.O(t);else{const s=new e;s.O(t),this.I.push(s)}}L(){return this.I.map((t=>t.W))}}const r=(t,s,i=0,e=Number.MAX_SAFE_INTEGER)=>{if(!Number.isInteger(s)||s<i||s>e)throw new Error(`${t} is invalid (${s})`);return s},h=(t,s,i=0,e=Number.MAX_VALUE)=>{if(Number(s)!==s||s<i||s>e)throw new Error(`${t} is invalid (${s})`);return s},o=(t,s)=>{if(!s||"[object Function]"!=={}.toString.call(s))throw new Error(`${t} is invalid (${s})`);return s};var a=t=>{var s,i,e,n,a,u,c,l;return[r("pixels",null!=(s=t.pixels)?s:1e4,1),h("distance",null!=(i=t.distance)?i:.12,0,1),r("splitPower",null!=(e=t.splitPower)?e:10,2,15),o("colorValidator",null!=(n=t.colorValidator)?n:(t,s,i,e)=>(null!=e?e:255)>250),h("hueDistance",null!=(a=t.hueDistance)?a:.08333333333333333,0,1),h("saturationDistance",null!=(u=t.saturationDistance)?u:.2,0,1),h("lightnessDistance",null!=(c=t.lightnessDistance)?c:.2,0,1),null!=(l=t.crossOrigin)?l:null]};class u{constructor(){this.i=1,this.S={}}O(t,i,e,n){return this.S[t]?this.S[t].i++:this.S[t]=new s(i,e,n,t),this.S[t]}k(){return Object.keys(this.S).map((t=>this.S[t]))}T(t){if(void 0===this.B){const s=this.k().map((s=>s.i/t));s.sort(((t,s)=>s-t)),this.B=s[0]||0}return this.B}F(t){const s=this.k();return s.sort(((s,i)=>i.i/t-s.i/t)),s[0]}H(){return this.k().reduce(((t,s)=>t.i>=s.i?t:s))}}class c{constructor(){this.i=1,this.S={}}R(t){return this.S[t]?this.S[t].i++:this.S[t]=new c,this.S[t]}k(){return Object.keys(this.S).map((t=>this.S[t]))}V(t){return this.S[t]?this.S[t].i++:this.S[t]=new u,this.S[t]}T(t){if(void 0===this.B){const s=this.k().map((s=>s.i/t));s.sort(((t,s)=>s-t)),this.B=s[0]||0}return this.B}F(t){const s=this.k();return s.sort(((s,i)=>i.i/t-s.i/t)),s[0].F(t)}H(){return this.k().reduce(((t,s)=>t.H().i>=s.H().i?t:s)).H()}q(t,i){const e=this.k().map((t=>{const{i:s}=t,i=t.H();return i.i=s,i}));e.sort(((t,s)=>s.i/i-t.i/i));const n=[];return e.forEach((i=>{const e=n.find((e=>s.distance(e,i)<t));e?e.i+=i.i:n.push(i)})),n}}var l=({data:t,width:s,height:i},e,n,r,h)=>{const o=new c,a=s&&i&&Math.floor(s*i/e)||1;for(let u=0;u<t.length;u+=4*a){const s=t[u],i=t[u+1],e=t[u+2];if(h(s,i,e,t[u+3])){const t=s<<16|i<<8|e,n=(s>>4&15)<<8|(i>>4&15)<<4|e>>4&15,h=Math.round(s*(r-1)/255)*(r*r)+Math.round(i*(r-1)/255)*r+Math.round(e*(r-1)/255);o.R(h).V(n).O(t,s,i,e)}}return o.q(n,e)};const d=(t,s,i,e,r)=>{const h=((t,s,i,e,r)=>{const h=new n(i,e,r);t.forEach((t=>h.O(t)));const o=h.L();return o.sort(((t,i)=>(i.j+.1)*(.9-i.i/s)-(t.j+.1)*(.9-t.i/s))),o})(t,s,i,e,r);return h.map((t=>((t,s)=>({hex:`#${"0".repeat(6-t.m.toString(16).length)}${t.m.toString(16)}`,red:t.g,green:t.M,blue:t.p,area:t.i/s,hue:t.C,saturation:t.$,lightness:t._,intensity:t.j}))(t,s)))},f=(t,s={})=>{const[i,e,n,r,h,o,u]=a(s),c=l(t,i,e,n,r),f=t.width&&t.height?Math.min(t.width*t.height,i):i;return d(c,f,h,o,u)},g=(t,s={})=>{const[i,e,n,r,h,o,u,c]=a(s);return t.crossOrigin=c,new Promise((s=>{const a=t=>{const a=((t,s)=>{const i=t.width*t.height,e=i<s?t.width:Math.round(t.width*Math.sqrt(s/i)),n=i<s?t.height:Math.round(t.height*Math.sqrt(s/i)),r=document.createElement("canvas");r.width=e,r.height=n;const h=r.getContext("2d");return h.drawImage(t,0,0,t.width,t.height,0,0,e,n),h.getImageData(0,0,e,n)})(t,i),c=l(a,i,e,n,r);s(d(c,i,h,o,u))};if(t.complete)a(t);else{const s=()=>{t.removeEventListener("load",s),a(t)};t.addEventListener("load",s)}}))},M=(t,s={})=>{const i=new Image;return i.src=t,g(i,s)},w=(t,s)=>{if(t instanceof Image)return g(t,s);if(t instanceof ImageData||t instanceof Object&&t.data)return new Promise((i=>{i(f(t,s))}));if("string"==typeof t)return M(t,s);throw new Error("Can not analyse picture")};t.default=w,t.extractColors=w,t.extractColorsFromImage=g,t.extractColorsFromImageData=f,t.extractColorsFromSrc=M,Object.defineProperties(t,{A:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
//# sourceMappingURL=extract-colors.browser.umd.js.map
